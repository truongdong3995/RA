# ユーザー情報一覧API
  - ユーザー情報データ用のインターフェースを作成する

## APIレイアウト
 ![markdown](https://images.viblo.asia/518eea86-f0bd-45c9-bf38-d5cb119e947d.png)
  - [L_9001_ユーザー情報_XML](./xml/L_9001_ユーザー情報.drawio.xml)

## API一覧

| No | ID | API名 | 備考 | 
| --- | --- | --- | --- |
| 1   | L_9001_001 | ユーザー情報_取得 |-|
| 2   | L_9001_002 | ユーザー情報_検索 |-|
| 3   | L_9001_003 | ユーザー情報_登録 |-|
| 4   | L_9001_004 | ユーザー情報_更新 |-|
| 5   | L_9001_005 | ユーザー情報_削除 |-|
| 6   | L_9001_006 | ユーザー情報_一括登録 |-|

## エンティティ一覧

| No | ID | エンティティ名 | 備考 | 
| :---: | --- | --- | --- |
| 1   | UserInfo | ユーザー情報 |-|

## L_9001_001_ユーザー情報_取得 (userInfo/getUserInfo)
  - 指定したユーザーIDのユーザー情報を取得する

### INPUT
  - ユーザーID

### OUTPUT
  - `ユーザー情報`エンティティ

### メソッド
  - GET

### APIの詳細処理
1. INPUTデータをチェックする
  - `INPUT.ユーザーID`が存在しない場合、下記のメッセージを返却して、処理を終了する。
    - ステータスコード：500
    - メッセージ内容：「指定したユーザーIDが不正です。再確認してください。」

2. DBに接続して、下記の情報通りにユーザー情報を取得する
  - INPUT:
      - ユーザー情報.ユーザーID = INPUT.ユーザーID
  - OUTPUT:
    - `ユーザー情報`

3. 上記の処理で`ユーザー情報`が取得できなかった場合、下記のメッセージを返却して、処理を終了する。
  - ステータスコード：400
  - メッセージ内容：「指定したユーザーIDが見つかれません。再確認してください。」

4. 上記の処理で`ユーザー情報`が取得できた場合、`ユーザー情報`を返却して、処理を終了する。



## L_9001_006_ユーザー情報_一括登録 (userInfo/RegisterAllUserInfo)
  - 指定したユーザー情報リスト(A)を登録する。

### INPUT
  - ユーザー情報リスト`(A)`

### OUTPUT
  - `ユーザー情報リスト`エンティティ

### メソッド
  - POST

### APIの詳細処理

1. INPUTデータをチェックする
  - INPUT.ユーザー情報リスト`A`が存在しない場合、下記のメッセージを返却して、処理を終了する。
    - ステータスコード：400
    - メッセージ内容：「登録対象ユーザー情報リストを指定してください。」

2. 登録又は更新データを分別する
  - ユーザー情報登録リスト`(A1)`を定義する。
  - ユーザー情報更新リスト`(A2)`を定義する。
  - ユーザー情報リスト`(A)`を繰り返し、ユーザー情報`(B)`を取得する。
    - L_9001_001_ユーザー情報_取得APIを呼び出し、ユーザー情報`(B1)`を取得する。
      - INPUT:
        - ユーザー情報.ユーザーID = `(B)`.ユーザーID
      - OUTPUT:
         - ユーザー情報`(B1)`

    - ユーザー情報`(B1)`が取得できなかった場合、`(A1)`に`(B1)`を追加する。
    - ユーザー情報`(B1)`が取得できた場合、`(A2)`に`(B1)`を追加する。

3. ユーザー情報を登録及び更新処理を実施する。
  - ユーザー情報返却リスト`(A3)`を定義する。
  - ユーザー情報登録リスト`(A1)`を繰り返し、ユーザー情報`(B2)`を取得する
    - L_9001_003_ユーザー情報_登録APIを呼び出し、ユーザー情報`(B2)`を登録する。
      - INPUT:
        - ユーザー情報`(B2)`
      - OUTPUT:
         - ユーザー情報`(B3)`

    - ユーザー情報返却エンティティ`D1`を生成する
      - D1.ユーザー情報 = `(B3)`
      - D1.insertFlag = `insert`
    - `(A3)`に`(D1)`を追加する。

    - L_9001_004_ユーザー情報_登録APIを呼び出し、ユーザー情報`(B4)`を更新する。
      - INPUT:
        - ユーザー情報`(B4)`
      - OUTPUT:
         - ユーザー情報`(B5)`
    - D1を生成する
      - D1.ユーザー情報 = `(B5)`
      - D1.insertFlag = `update`
    - `(A3)`に`(D1)`を追加する。

4. `(A3)`リストを返却し、処理を処理を終了する。

## 共通処理
### ユーザー情報返却エンティティ
  - 下記の内容通りに、`ユーザー情報エンティティ`返却を定義する

  | No | ID | API名 | 備考 | 
  | :---: | --- | --- | --- |
  | 1   | UserInfo | ユーザー情報 |エンティティ|
  | 2   |insertFlag | 登録フラグ |値：insert/update|

